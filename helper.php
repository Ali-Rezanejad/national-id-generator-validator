<?php
function fixPersianText($text) {
    $characters = preg_split('//u', $text, -1, PREG_SPLIT_NO_EMPTY);

    $reversed = [];
    $buffer = '';

    foreach ($characters as $char) {
        if (preg_match('/\d/', $char)) {
            $buffer .= $char;
        } else {
            if ($buffer !== '') {
                $reversed[] = $buffer; 
                $buffer = '';
            }
            $reversed[] = $char; 
        }
    }

    if ($buffer !== '') {
        $reversed[] = $buffer;
    }

    return implode('', array_reverse($reversed));
}

$cityCodes = [
    '001' => 'تهران مرکزی', '002' => 'تهران مرکزی', '003' => 'تهران مرکزی', '004' => 'تهران مرکزی',
    '005' => 'تهران مرکزی', '006' => 'تهران مرکزی', '007' => 'تهران مرکزی', '008' => 'تهران مرکزی',
    '011' => 'تهران جنوب', '015' => 'تهران غرب', '020' => 'تهران شرق', '025' => 'تهران شمال',
    '031' => 'کرج', '032' => 'کرج', '041' => 'ورامین', '042' => 'ورامین', '043' => 'دماوند',
    '044' => 'شمیران', '045' => 'شمیران', '048' => 'شهرری', '049' => 'شهرری',
    '051' => 'آشتیان', '052' => 'اراک', '053' => 'اراک', '055' => 'خمین', '056' => 'محلات',
    '057' => 'دلیجان', '058' => 'تفرش', '059' => 'ساوه', '060' => 'ساوه', '061' => 'سربند',
    '062' => 'سربند', '067' => 'بجنورد', '068' => 'بجنورد', '069' => 'تربت حیدریه', '070' => 'تربت حیدریه',
    '072' => 'تربت جام', '073' => 'تربت جام', '074' => 'تایباد', '075' => 'جاجرم', '076' => 'خواف',
    '077' => 'درگز', '078' => 'سبزوار', '079' => 'سبزوار', '081' => 'سرخس', '082' => 'شیروان',
    '083' => 'طبس', '084' => 'فریمان', '085' => 'فردوس', '086' => 'قوچان', '087' => 'قوچان',
    '088' => 'قائنات', '089' => 'کاشمر', '090' => 'کاشمر', '091' => 'گناباد', '092' => 'مشهد',
    '093' => 'مشهد', '094' => 'مشهد', '096' => 'مشهد منطقه 1', '097' => 'مشهد منطقه 2', '098' => 'مشهد منطقه 3',
    '105' => 'نیشابور', '106' => 'نیشابور', '108' => 'نجف آباد', '109' => 'نجف آباد',
    '110' => 'فلاورجان', '111' => 'فلاورجان', '112' => 'فریدونشهر', '113' => 'خمینی شهر',
    '114' => 'خمینی شهر', '115' => 'فریدن', '116' => 'لنجان(زرینشهر)', '117' => 'لنجان(زرینشهر)',
    '118' => 'اردستان', '119' => 'شهرضا', '120' => 'سمیرم', '121' => 'گلپایگان', '122' => 'خوانسار',
    '123' => 'نطنز', '124' => 'نائین', '125' => 'کاشان', '126' => 'کاشان', '127' => 'اصفهان',
    '128' => 'اصفهان', '129' => 'اصفهان', '136' => 'تبریز', '137' => 'تبریز', '138' => 'تبریز',
    '145' => 'اردبیل', '146' => 'اردبیل', '149' => 'اهر', '150' => 'اهر', '152' => 'میانه',
    '153' => 'میانه', '154' => 'مراغه', '155' => 'مراغه', '158' => 'مرند', '159' => 'هشترود',
    '160' => 'هشترود', '161' => 'مغان', '162' => 'مغان', '163' => 'خلخال', '164' => 'سراب',
    '165' => 'سراب', '166' => 'مشکین شهر', '167' => 'مشکین شهر', '168' => 'بناب', '169' => 'آذرشهر',
    '170' => 'اسکو', '171' => 'بستان آباد', '172' => 'شبستر', '173' => 'هریس', '174' => 'اهواز',
    '175' => 'اهواز', '181' => 'آبادان', '182' => 'خرمشهر', '183' => 'ایذه', '184' => 'ایذه',
    '185' => 'بهبهان', '186' => 'بهبهان', '187' => 'شوشتر', '188' => 'شوشتر', '189' => 'شادگان',
    '190' => 'رامهرمز', '191' => 'رامهرمز', '192' => 'اندیمشک', '193' => 'اندیمشک', '194' => 'بندرماهشهر',
    '195' => 'بندرماهشهر', '196' => 'مسجدسلیمان', '197' => 'مسجدسلیمان', '198' => 'دشت آزادگان',
    '199' => 'دزفول', '200' => 'دزفول', '202' => 'گنبد کاووس', '203' => 'گنبد کاووس', '205' => 'بابل',
    '206' => 'بابل', '208' => 'ساری', '209' => 'ساری', '211' => 'گرگان', '212' => 'گرگان',
    '213' => 'آمل', '214' => 'آمل', '215' => 'قائمشهر', '216' => 'قائمشهر', '217' => 'بهشهر',
    '218' => 'بهشهر', '219' => 'نوشهر', '220' => 'نوشهر', '221' => 'تنکابن', '222' => 'نور',
    '223' => 'بندرترکمن', '224' => 'کردکوی', '225' => 'سوادکوه', '226' => 'علی آباد', '227' => 'رامسر',
    '228' => 'شیراز', '229' => 'شیراز', '230' => 'شیراز',
    // بقیه کدها را میتوان به همین ترتیب اضافه کرد
];